!function(){"use strict";let t,e,n,o=[],a={},i="right",r="right",s=0,l=localStorage.getItem("ghostSnakeHighScore")||0,h=!1,c=!1,d=20,u=100,g=0,f=0;localStorage.getItem("snakeMuted");let m=[],p=1,y=2;const x="rgba(255, 107, 0, 0.1)",w="#ffffff",b="#0a0a0f",v={eat:new Howl({src:["https://assets.codepen.io/21542/howler-push.mp3"],volume:.3}),die:new Howl({src:["https://assets.codepen.io/21542/howler-metal-hit.mp3"],volume:.3}),move:new Howl({src:["https://assets.codepen.io/21542/howler-tap.mp3"],volume:.1})},k={head:{up:"ðŸ‘»",down:"ðŸ‘»",left:"ðŸ‘»",right:"ðŸ‘»"},body:"ðŸ’¨",food:"ðŸ”®",bomb:"ðŸ’£"},I={head:{up:new Image,down:new Image,left:new Image,right:new Image},body:new Image,food:new Image};function E(){document.querySelector(".game-container");const e=Math.min(window.innerWidth-40,600);t.width=e,t.height=e,d=Math.floor(e/30),T()}function B(){h||(h=!0,document.getElementById("startBtn").textContent="Restart",document.getElementById("pauseBtn").style.display="inline-block"),A()}function M(){h&&(c?(n=setInterval(L,u),document.getElementById("pauseBtn").textContent="Pause"):(clearInterval(n),document.getElementById("pauseBtn").textContent="Resume"),c=!c)}function A(){n&&clearInterval(n),o=[{x:3,y:1},{x:2,y:1},{x:1,y:1}],i="right",r="right",s=0,p=1,u=100,y=2,c=!1,document.getElementById("pauseBtn").textContent="Pause",H(),S(),C(),n=setInterval(L,u),T()}function S(){const e=Math.floor(t.width/d),n=Math.floor(t.height/d);do{a={x:Math.floor(Math.random()*(e-2))+1,y:Math.floor(Math.random()*(n-2))+1}}while(o.some(t=>t.x===a.x&&t.y===a.y))}function C(){m=[];const e=Math.floor(t.width/d),n=Math.floor(t.height/d);for(let t=0;t<y;t++){let t;do{t={x:Math.floor(Math.random()*(e-2))+1,y:Math.floor(Math.random()*(n-2))+1}}while(o.some(e=>e.x===t.x&&e.y===t.y)||a.x===t.x&&a.y===t.y||m.some(e=>e.x===t.x&&e.y===t.y));m.push(t)}}function L(){const g={x:o[0].x,y:o[0].y};switch(i=r,i){case"up":g.y--;break;case"down":g.y++;break;case"left":g.x--;break;case"right":g.x++}if(function(e){const n=Math.floor(t.width/d),a=Math.floor(t.height/d);if(e.x<0||e.x>=n||e.y<0||e.y>=a)return!0;if(o.some((t,n)=>0!==n&&(t.x===e.x&&t.y===e.y)))return!0;return m.some(t=>t.x===e.x&&t.y===e.y)}(g))return clearInterval(n),h=!1,c=!1,v.die.play(),gsap.to(t,{x:10,duration:.1,repeat:3,yoyo:!0,onComplete:()=>{gsap.set(t,{x:0})}}),document.getElementById("startBtn").textContent="Start",document.getElementById("pauseBtn").style.display="none",e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(0,0,t.width,t.height),e.fillStyle=w,e.font='bold 30px "Press Start 2P"',e.textAlign="center",void gsap.from({},{duration:.5,onComplete:()=>{e.fillText("GAME OVER",t.width/2,t.height/2)}});o.unshift(g),g.x===a.x&&g.y===a.y?(s++,v.eat.play(),s%5==0&&function(){p++,u*=.9,y=Math.min(y+1,10),clearInterval(n),n=setInterval(L,u),H();const o=`Level ${p}!`;e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(0,0,t.width,t.height),e.fillStyle=w,e.font='bold 30px "Press Start 2P"',e.textAlign="center",e.fillText(o,t.width/2,t.height/2),m.forEach(t=>{gsap.to({},{duration:.5,repeat:1,yoyo:!0,onUpdate:()=>{const n=1+.2*Math.sin(Date.now()/100);e.font=d*n+"px Arial",e.fillText(k.bomb,t.x*d+d/2,t.y*d+d/2)}})})}(),s>l&&(l=s,localStorage.setItem("ghostSnakeHighScore",l)),H(),S(),C()):o.pop(),T()}function T(){e.fillStyle=b,e.fillRect(0,0,t.width,t.height),function(){e.strokeStyle=x,e.lineWidth=.5;for(let n=0;n<t.width;n+=d)e.beginPath(),e.moveTo(n,0),e.lineTo(n,t.height),e.stroke();for(let n=0;n<t.height;n+=d)e.beginPath(),e.moveTo(0,n),e.lineTo(t.width,n),e.stroke()}(),e.save(),e.font=`${d}px Arial`,e.textAlign="center",e.textBaseline="middle",m.forEach(t=>{const n=1+.1*Math.sin(Date.now()/500);e.font=d*n+"px Arial",e.fillText(k.bomb,t.x*d+d/2,t.y*d+d/2)}),e.restore(),o.forEach((t,n)=>{e.save(),e.font=`${d}px Arial`,e.textAlign="center",e.textBaseline="middle";const a=t.x*d+d/2,r=t.y*d+d/2;0===n?(e.font=1.2*d+"px Arial",e.fillText(k.head[i],a,r)):(e.globalAlpha=1-n/o.length*.5,e.fillText(k.body,a,r)),e.restore()}),e.save(),e.font=`${d}px Arial`,e.textAlign="center",e.textBaseline="middle";const n=1+.1*Math.sin(Date.now()/200);e.font=d*n+"px Arial",e.fillText(k.food,a.x*d+d/2,a.y*d+d/2),e.restore()}function D(t){if(h)switch(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Space"].includes(t.key)&&t.preventDefault(),t.key){case"ArrowUp":"down"!==i&&(r="up");break;case"ArrowDown":"up"!==i&&(r="down");break;case"ArrowLeft":"right"!==i&&(r="left");break;case"ArrowRight":"left"!==i&&(r="right");break;case"Space":M()}}function P(t){g=t.touches[0].clientX,f=t.touches[0].clientY}function R(t){if(!h||!g||!f)return;t.preventDefault();const e=t.touches[0].clientX,n=t.touches[0].clientY,o=e-g,a=n-f;Math.abs(o)>Math.abs(a)?o>0&&"left"!==i?r="right":o<0&&"right"!==i&&(r="left"):a>0&&"up"!==i?r="down":a<0&&"down"!==i&&(r="up"),g=e,f=n}function j(t){h&&!c&&t.preventDefault()}function H(){document.getElementById("currentScore").textContent=s,document.getElementById("currentLevel").textContent=p,document.getElementById("highScoreDisplay").textContent=l}I.head.up.src="https://raw.githubusercontent.com/jaylikesbunda/ghost-snake/main/sprites/ghost-up.png",I.head.down.src="https://raw.githubusercontent.com/jaylikesbunda/ghost-snake/main/sprites/ghost-down.png",I.head.left.src="https://raw.githubusercontent.com/jaylikesbunda/ghost-snake/main/sprites/ghost-left.png",I.head.right.src="https://raw.githubusercontent.com/jaylikesbunda/ghost-snake/main/sprites/ghost-right.png",I.body.src="https://raw.githubusercontent.com/jaylikesbunda/ghost-snake/main/sprites/ghost-trail.png",I.food.src="https://raw.githubusercontent.com/jaylikesbunda/ghost-snake/main/sprites/ghost-food.png",document.addEventListener("DOMContentLoaded",function(){t=document.getElementById("snakeCanvas"),e=t.getContext("2d"),E(),window.addEventListener("resize",E),o=[{x:3,y:1},{x:2,y:1},{x:1,y:1}],H(),S(),document.addEventListener("keydown",D),t.addEventListener("touchstart",P,{passive:!1}),t.addEventListener("touchmove",R,{passive:!1}),document.body.addEventListener("touchmove",j,{passive:!1}),document.getElementById("startBtn").addEventListener("click",B),document.getElementById("pauseBtn").addEventListener("click",M),T()})}();
